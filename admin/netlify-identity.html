<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Netlify Identity Setup</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      max-width: 800px;
      margin: 50px auto;
      padding: 0 20px;
      line-height: 1.6;
    }
    h1 { color: #7C3AED; }
    code {
      background: #f5f5f5;
      padding: 2px 6px;
      border-radius: 3px;
      font-size: 0.9em;
    }
    pre {
      background: #f5f5f5;
      padding: 15px;
      border-radius: 5px;
      overflow-x: auto;
    }
    .step {
      background: #f9f9f9;
      padding: 20px;
      margin: 20px 0;
      border-left: 4px solid #7C3AED;
      border-radius: 4px;
    }
    .note {
      background: #fff3cd;
      padding: 15px;
      border-left: 4px solid #ffc107;
      margin: 20px 0;
    }
  </style>
</head>
<body>
  <h1>üîê Setting Up Netlify Identity</h1>
  
  <p>This guide will help you set up authentication for your Decap CMS using Netlify Identity.</p>
  
  <div class="step">
    <h2>Step 1: Deploy to Netlify</h2>
    <ol>
      <li>Push your code to GitHub</li>
      <li>Go to <a href="https://app.netlify.com" target="_blank">Netlify</a></li>
      <li>Click "New site from Git"</li>
      <li>Connect your repository</li>
      <li>Deploy</li>
    </ol>
  </div>
  
  <div class="step">
    <h2>Step 2: Enable Identity</h2>
    <ol>
      <li>In your Netlify site dashboard, go to <strong>Identity</strong></li>
      <li>Click <strong>"Enable Identity"</strong></li>
      <li>Under <strong>Registration preferences</strong>, set to "Invite only" (recommended)</li>
      <li>Under <strong>External providers</strong>, enable GitHub or Google if desired</li>
    </ol>
  </div>
  
  <div class="step">
    <h2>Step 3: Enable Git Gateway</h2>
    <ol>
      <li>In Identity settings, scroll to <strong>Services</strong></li>
      <li>Click <strong>"Enable Git Gateway"</strong></li>
      <li>This allows the CMS to commit directly to your repository</li>
    </ol>
  </div>
  
  <div class="step">
    <h2>Step 4: Add Identity Widget</h2>
    <p>Add this script to your <code>index.html</code> before the closing <code>&lt;/head&gt;</code> tag:</p>
    <pre><code>&lt;script src="https://identity.netlify.com/v1/netlify-identity-widget.js"&gt;&lt;/script&gt;</code></pre>
    
    <p>And add this script before the closing <code>&lt;/body&gt;</code> tag:</p>
    <pre><code>&lt;script&gt;
  if (window.netlifyIdentity) {
    window.netlifyIdentity.on("init", user => {
      if (!user) {
        window.netlifyIdentity.on("login", () => {
          document.location.href = "/admin/";
        });
      }
    });
  }
&lt;/script&gt;</code></pre>
  </div>
  
  <div class="step">
    <h2>Step 5: Invite Yourself</h2>
    <ol>
      <li>Go to <strong>Identity</strong> tab in Netlify</li>
      <li>Click <strong>"Invite users"</strong></li>
      <li>Enter your email address</li>
      <li>Check your email for the invitation</li>
      <li>Click the link and set your password</li>
    </ol>
  </div>
  
  <div class="step">
    <h2>Step 6: Test the CMS</h2>
    <ol>
      <li>Visit <code>https://yoursite.netlify.app/admin</code></li>
      <li>Log in with your credentials</li>
      <li>Start creating articles!</li>
    </ol>
  </div>
  
  <div class="note">
    <strong>‚ö†Ô∏è Important:</strong> Make sure your <code>admin/config.yml</code> has the correct backend:
    <pre><code>backend:
  name: git-gateway
  branch: main</code></pre>
  </div>
  
  <h2>Troubleshooting</h2>
  
  <h3>Can't log in?</h3>
  <ul>
    <li>Make sure Identity is enabled in Netlify</li>
    <li>Check that Git Gateway is enabled</li>
    <li>Verify the Identity widget script is loaded</li>
    <li>Clear your browser cache and try again</li>
  </ul>
  
  <h3>CMS loads but can't save articles?</h3>
  <ul>
    <li>Verify Git Gateway is enabled</li>
    <li>Check your backend configuration in config.yml</li>
    <li>Make sure the branch name matches your repo (main vs master)</li>
  </ul>
  
  <h2>Resources</h2>
  <ul>
    <li><a href="https://docs.netlify.com/visitor-access/identity/" target="_blank">Netlify Identity Documentation</a></li>
    <li><a href="https://decapcms.org/docs/netlify-identity-authentication/" target="_blank">Decap CMS + Netlify Identity</a></li>
    <li><a href="https://docs.netlify.com/visitor-access/git-gateway/" target="_blank">Git Gateway Documentation</a></li>
  </ul>
  
  <hr>
  <p><a href="/admin">‚Üê Back to CMS</a></p>
</body>
</html>

